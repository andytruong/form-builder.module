<?php

use AndyTruong\Uuid\Uuid;
use Drupal\form_builder\FormEntity;
use GO1\FormCenter\Manager\Manager;

require_once dirname(__FILE__) . '/form_builder.hooks.php';

/**
 * Factory access to form-center's manger.
 *
 * @staticvar Manager $manager
 * @return Manager
 */
function form_builder_manager()
{
    static $manager = null;

    if (null === $manager) {
        $manager = new Manager();
        $manager->setUuidGenerator($uuid_generator = Uuid::getGenerator());
    }

    return $manager;
}

/**
 * Wrapper for entity_access().
 *
 * @return boolean
 */
function form_builder_entity_access()
{
    if (user_access('administer forms')) {
        return true;
    }
    return call_user_func_array('entity_access', func_get_args());
}

/**
 * Define structure for form entity create/edit form.
 *
 * @param array $form
 * @param array $form_state
 * @param FormEntity $entity
 * @param string $op
 * @param string $entity_type
 * @return array
 */
function form_builder_form_form($form, &$form_state, FormEntity $entity, $op = 'edit', $entity_type = null)
{
    $form['name'] = array(
        '#type'          => 'textfield',
        '#title'         => t('Summary'),
        '#required'      => true,
        '#default_value' => $entity->getName(),
    );

    $form['actions'] = array('#type' => 'actions');
    $form['actions']['submit'] = array(
        '#type'   => 'submit',
        '#value'  => t('Save form'),
        '#weight' => 40,
    );

    return $form;
}
